<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>浏览器的渲染机制 | 文王之殇 –前端加油站</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="浏览器的渲染机制" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="浏览器的内核是指支持浏览器运行的最核心的程序，分为两个部分的，一是渲染引擎，另一个是JS引擎。渲染引擎在不同的浏览器中也不是都相同的。目前市面上常见的浏览器内核可以分为这四种：Trident（IE）、Gecko（火狐）、Blink（Chrome、Opera）、Webkit（Safari）。" />
<meta property="og:description" content="浏览器的内核是指支持浏览器运行的最核心的程序，分为两个部分的，一是渲染引擎，另一个是JS引擎。渲染引擎在不同的浏览器中也不是都相同的。目前市面上常见的浏览器内核可以分为这四种：Trident（IE）、Gecko（火狐）、Blink（Chrome、Opera）、Webkit（Safari）。" />
<link rel="canonical" href="http://localhost:4000/L_Basic/web_1/" />
<meta property="og:url" content="http://localhost:4000/L_Basic/web_1/" />
<meta property="og:site_name" content="文王之殇 –前端加油站" />
<script type="application/ld+json">
{"url":"http://localhost:4000/L_Basic/web_1/","headline":"浏览器的渲染机制","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"description":"浏览器的内核是指支持浏览器运行的最核心的程序，分为两个部分的，一是渲染引擎，另一个是JS引擎。渲染引擎在不同的浏览器中也不是都相同的。目前市面上常见的浏览器内核可以分为这四种：Trident（IE）、Gecko（火狐）、Blink（Chrome、Opera）、Webkit（Safari）。","@type":"Article","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="文王之殇 --前端加油站" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
		<div class="righttips" id="backtop">
			返回
		</div>
		<header>
			<div class="left_head">	
				<h1>
					<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="文王之殇 --前端加油站 logo"></a>
					文王之殇 --前端加油站
					<button type="button" class="open-nav" id="open-nav"></button>
				</h1>

				<form action="/search/" method="get">
					<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
					<input type="submit" value="Search" style="display: none;">
				</form>

			</div>
		
			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">欢迎</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/A_Css/vetically/">CSS</a>
							<ul>
								
									<li class="nav-item "><a href="/A_Css/vetically/">垂直居中</a></li>
								
									<li class="nav-item "><a href="/A_Css/box/">盒模型</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/B_Js/AMD_CMD/">JS 基础及概念</a>
							<ul>
								
									<li class="nav-item "><a href="/B_Js/AMD_CMD/">AMD、CMD、Common.js和ES6的异同</a></li>
								
									<li class="nav-item "><a href="/B_Js/es6_export/">export、export default 和 module.export的异同</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/C_Vue/documents/">Vue</a>
							<ul>
								
									<li class="nav-item "><a href="/C_Vue/documents/">Vue2</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/D_Webpack/webpack_1/">Webpack</a>
							<ul>
								
									<li class="nav-item "><a href="/D_Webpack/webpack_1/">Webpack 基础和进阶</a></li>
								
									<li class="nav-item "><a href="/D_Webpack/webpack_2/">Webpack 和 Vite 的比较</a></li>
								
									<li class="nav-item "><a href="/D_Webpack/webpack_3/">前端如何利用Webpack进行代码分析和优化</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/E_Node/node_1/">Node</a>
							<ul>
								
									<li class="nav-item "><a href="/E_Node/node_1/">Express的基础</a></li>
								
									<li class="nav-item "><a href="/E_Node/node_2/">Koa 基础</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/F_MiniProgram/mini_1/">小程序</a>
							<ul>
								
									<li class="nav-item "><a href="/F_MiniProgram/mini_1/">小程序渲染机制 --- 以微信小程序为例</a></li>
								
									<li class="nav-item "><a href="/F_MiniProgram/min_2/">小程序开发步骤讲解</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/G_Angular/angular_1/">Angular</a>
							<ul>
								
									<li class="nav-item "><a href="/G_Angular/angular_1/">浅析angular</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/K_React/react_1/">React</a>
							<ul>
								
									<li class="nav-item "><a href="/K_React/react_1/">React基础</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/L_Basic/web_1/">前端杂谈</a>
							<ul>
								
									<li class="nav-item current"><a href="/L_Basic/web_1/">浏览器的渲染机制</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_2/">前端部署的发展历程</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_3/">浏览器缓存机制</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_4/">xhr 和 fetch请求方式的比较</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_5/">输入一个url发生了什么</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_6/">http 演进</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_7/">前端大厦的基石 --- AST</a></li>
								
									<li class="nav-item "><a href="/L_Basic/web_8/">浅谈前端优化的方向</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/M_Program/program_1/">项目</a>
							<ul>
								
									<li class="nav-item "><a href="/M_Program/program_1/">数据可视化项目</a></li>
								
									<li class="nav-item "><a href="/M_Program/program_2/">新零售会员通 -- 天猫 有赞 微信会员渠道打通项目</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<!-- <h2>前端杂谈</h2> -->
				<h3>浏览器的渲染机制</h3>
			</div>
			<article class="content">
				<p>浏览器的内核是指支持浏览器运行的最核心的程序，分为两个部分的，一是渲染引擎，另一个是JS引擎。渲染引擎在不同的浏览器中也不是都相同的。目前市面上常见的浏览器内核可以分为这四种：Trident（IE）、Gecko（火狐）、Blink（Chrome、Opera）、Webkit（Safari）。</p>

<blockquote>
  <p>浏览器从输入url开始
  这里只做简述，如想详细了解可以参考我另一篇文章
    要点如下：
      浏览器根据 DNS 服务器得到域名的 IP 地址
      向这个 IP 的机器发送 HTTP 请求
      服务器收到、处理并返回 HTTP 请求
      浏览器得到返回内容
这里重点讲述 浏览器返回之后的内容</p>
</blockquote>

<p>其实就是一堆 HMTL 格式的字符串，因为只有 HTML 格式浏览器才能正确解析，这是 W3C 标准的要求。接下来就是浏览器的渲染过程。
  一、浏览器会解析三个东西：
    一是HTML/SVG/XHTML，HTML字符串描述了一个页面的结构，浏览器会把HTML结构字符串解析转换DOM树形结构</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>二是CSS，解析CSS会产生CSS规则树，它和DOM结构比较像。

三是Javascript脚本，等到Javascript 脚本文件加载后， 通过 DOM API 和 CSSOM API 来操作 DOM Tree 和 CSS Rule Tree。
</code></pre></div></div>

<p>二、解析完成后，浏览器引擎会通过DOM Tree 和 CSS Rule Tree 来构造 Rendering Tree。
  Rendering Tree 渲染树并不等同于DOM树，渲染树只会包括需要显示的节点和这些节点的样式信息。<br />
  CSS 的 Rule Tree主要是为了完成匹配并把CSS Rule附加上Rendering Tree上的每个Element（也就是每个Frame）。<br />
  然后，计算每个Frame 的位置，这又叫layout和reflow过程</p>

<p>三、最后通过调用操作系统Native GUI的API绘制</p>

<p>二、 构建DOM
    浏览器会遵守一套步骤将HTML 文件转换为 DOM 树。宏观上，可以分为几个步骤：</p>

<p>三、构建CSSOM</p>

<p>四、构建渲染树</p>

<p>五、布局与绘制</p>

<p>六、几点补充说明</p>

<p>性能优化策略
基于上面介绍的浏览器渲染原理，DOM 和 CSSOM 结构构建顺序，初始化可以对页面渲染做些优化，提升页面性能。</p>

<p>JS优化： <script> 标签加上 defer属性 和 async属性 用于在不阻塞页面文档解析的前提下，控制脚本的下载和执行。</script></p>

<p>defer属性： 用于开启新的线程下载脚本文件，并使脚本在文档解析完成后执行。
async属性： HTML5新增属性，用于异步下载脚本文件，下载完毕立即解释执行代码。</p>

<p>CSS优化： <link /> 标签的 rel属性 中的属性值设置为 preload 能够让你在你的HTML页面中可以指明哪些资源是在页面加载完成后即刻需要的,最优的配置加载顺序，提高渲染性能</p>

<p>总结
浏览器工作流程：构建DOM -&gt; 构建CSSOM -&gt; 构建渲染树 -&gt; 布局 -&gt; 绘制。
CSSOM会阻塞渲染，只有当CSSOM构建完毕后才会进入下一个阶段构建渲染树。
通常情况下DOM和CSSOM是并行构建的，但是当浏览器遇到一个不带defer或async属性的script标签时，DOM构建将暂停，如果此时又恰巧浏览器尚未完成CSSOM的下载和构建，由于JavaScript可以修改CSSOM，所以需要等CSSOM构建完毕后再执行JS，最后才重新DOM构建。</p>

<p>参考：https://juejin.cn/post/6844903815758479374</p>


			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
			document.getElementById("backtop").addEventListener("click", function () {
				document.body.scrollTop = 0;
    		document.documentElement.scrollTop = 0;
			});

		</script>
	</body>
</html>
